(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4ba45aeb"],{"2f21":function(t,e,a){"use strict";var i=a("79e5");t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},"55dd":function(t,e,a){"use strict";var i=a("5ca1"),c=a("d8e8"),r=a("4bf8"),n=a("79e5"),s=[].sort,o=[1,2,3];i(i.P+i.F*(n(function(){o.sort(void 0)})||!n(function(){o.sort(null)})||!a("2f21")(s)),"Array",{sort:function(t){return void 0===t?s.call(r(this)):s.call(r(this),c(t))}})},"5fc4":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("l-map",{staticClass:"oehu-map",attrs:{zoom:t.map.zoom,center:t.map.center,options:{zoomControl:!0,touchZoom:!0,scrollWheelZoom:!1,doubleClickZoom:!0,boxZoom:!0}},on:{"update:center":t.centerUpdate,"update:zoom":t.zoomUpdate}},[a("l-tile-layer",{attrs:{url:t.map.url,attribution:t.map.attribution}}),t._l(t.markers,function(e,i){return a("l-marker",{key:i,attrs:{icon:t.LIcon,"lat-lng":e.position}},[a("LTooltip",{attrs:{content:e.tooltip}})],1)})],2)],1)},c=[],r=(a("cadf"),a("551c"),a("097d"),a("458e")),n=a("e11e"),s=a.n(n),o={name:"Map",components:{LMap:r["LMap"],LTileLayer:r["LTileLayer"],LMarker:r["LMarker"],LTooltip:r["LTooltip"]},props:["markers"],data:function(){return{map:{zoom:7,currentZoom:10,center:{lat:52.0182305,lng:4.6910549},currentCenter:{lat:52.0182305,lng:4.6910549},url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}{r}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors'},LIcon:s.a.icon({iconUrl:"/marker-icon.png",iconRetinaUrl:"/marker-icon-2x.png",iconSize:[50,50],iconAnchor:[25,25],popupAnchor:[0,0]})}},methods:{zoomUpdate:function(t){this.map.currentZoom=t},centerUpdate:function(t){this.map.currentCenter=t}}},d=o,l=(a("a228"),a("2877")),v=Object(l["a"])(d,i,c,!1,null,"76d908f0",null);v.options.__file="Map.vue";e["a"]=v.exports},"66c0":function(t,e,a){},"7c20":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"device-data-list flex flex-wrap"},[t._m(0),t._l(t.transactions,function(e){return a("div",{key:e.id,staticClass:"device-data-list_item"},[a("div",{staticClass:"lastUpdateFormatted"},[t._v("\n      "+t._s(e.metadata.metadata.lastUpdateFormatted)+"\n    ")]),a("div",{staticClass:"electricityReceived"},[a("span",[t._v(t._s(e.metadata.metadata.electricityReceived.total?e.metadata.metadata.electricityReceived.total.toFixed(2):0))]),a("span",[t._v(t._s(e.metadata.metadata.electricityReceived.tariff1?e.metadata.metadata.electricityReceived.tariff1.toFixed(2):0))]),a("span",[t._v(t._s(e.metadata.metadata.electricityReceived.tariff2?e.metadata.metadata.electricityReceived.tariff2.toFixed(2):0))])]),a("div",{staticClass:"electricityDelivered"},[a("span",[t._v(t._s(e.metadata.metadata.electricityDelivered.total?e.metadata.metadata.electricityDelivered.total.toFixed(2):0))]),a("span",[t._v(t._s(e.metadata.metadata.electricityDelivered.tariff1?e.metadata.metadata.electricityDelivered.tariff1.toFixed(2):0))]),a("span",[t._v(t._s(e.metadata.metadata.electricityDelivered.tariff2?e.metadata.metadata.electricityDelivered.tariff2.toFixed(2):0))])]),a("div",{staticClass:"gasReceived"},[t._v("\n      "+t._s(e.metadata.metadata.gasReceived)+"\n    ")]),a("div",{staticClass:"deviceId",attrs:{title:e.deviceId}},[t._v("\n      "+t._s(e.deviceId)+"\n    ")])])})],2)},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"device-data-list_item table-header"},[a("div",{staticClass:"lastUpdateFormatted"},[t._v("Date/time")]),a("div",{staticClass:"electricityReceived"},[t._v("\n      KwH received\n      "),a("div",[a("span",[t._v("Total")]),a("span",[t._v("Tariff1")]),a("span",[t._v("Tariff2")])])]),a("div",{staticClass:"electricityDelivered"},[t._v("\n      KwH delivered\n      "),a("div",[a("span",[t._v("Total")]),a("span",[t._v("Tariff1")]),a("span",[t._v("Tariff2")])])]),a("div",{staticClass:"gasReceived"},[t._v("Gas received")]),a("div",{staticClass:"deviceId"},[t._v("Device")])])}],r=(a("55dd"),a("96cf"),a("3040")),n=a("c1df"),s=a.n(n),o=a("90cd"),d=a("8db5"),l=function(t){var e="https://api.oehu.org/transactions?raw=true";return e+(t?"&deviceId="+t:"")},v=function(t){var e=[],a=[];for(var i in t)void 0==a[t[i].asset.id]&&(e.push(t[i]),a[t[i].asset.id]=!0);return e},u={name:"device-data-list",props:["deviceId"],data:function(){return{transactions:[]}},components:{Button:o["a"],Title:d["a"]},methods:{getTransactions:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,a,i,c,r,n,o,d,u;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e=this,t.next=4,this.axios.get(l(this.deviceId));case 4:for(a=t.sent,i=0;i<=a.data.length-1;i++)a.data[i].metadata.metadata.lastUpdateFormatted=s()(a.data[i].metadata.metadata.lastUpdate).format("YYYY-MM-DD HH:mm:ss");for(e.transactions=a.data,console.log(e.transactions),e.transactions.sort(function(t,e){return e.metadata.metadata.lastUpdate-t.metadata.metadata.lastUpdate}),this.deviceId||(e.transactions=v(e.transactions)),c=[],r=[],n=a.data.slice(1,3),o=0;o<n.length;o++)c.push(n[o].metadata.metadata.electricityReceived.total),r.push(n[o].metadata.metadata.gasReceived);d=c[0]-c[1],u=r[0]-r[1],this.$root.$emit("currentElectricity",d),this.$root.$emit("currentGas",u),setTimeout(function(){e.getTransactions()},6e4),t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](0),console.error(t.t0);case 24:case"end":return t.stop()}},t,this,[[0,21]])}));return function(){return t.apply(this,arguments)}}()},mounted:function(){this.getTransactions()}},m=u,p=(a("d02a"),a("2877")),f=Object(p["a"])(m,i,c,!1,null,"121c983d",null);f.options.__file="DeviceDataList.vue";e["a"]=f.exports},"7e14":function(t,e,a){"use strict";var i=a("66c0"),c=a.n(i);c.a},a228:function(t,e,a){"use strict";var i=a("ab89"),c=a.n(i);c.a},ab89:function(t,e,a){},aff5:function(t,e,a){},ba99:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"explorer"},[a("Logo"),a("div",{staticClass:"container"},[a("Title",{staticClass:"Title",attrs:{align:"center",title:"OEHU Data Explorer"}}),a("p",{attrs:{align:"center"}},[t._v("\n            This page shows info from all OEHU connected devices.\n        ")]),a("br"),a("Maps")],1),a("DevicesConnected"),a("DeviceDataList"),a("br"),a("br"),a("br"),a("br"),a("Footer"),a("FooterClosing")],1)},c=[],r=(a("96cf"),a("3040")),n=(a("cadf"),a("551c"),a("097d"),a("90cd")),s=a("7c20"),o=a("4c03"),d=a("0b2d"),l=a("109c"),v=a("2241"),u=a("5fc4"),m=a("e8e4"),p=a("495e"),f=a("8db5"),h={name:"dashboard",data:function(){return{data:[],isCookieSet:!1,deviceId:0,devices:[],electricityReceived:0,electricityDelivered:0,gasReceived:0}},components:{Meter:p["a"],Logo:v["a"],Button:n["a"],DeviceDataList:s["a"],DevicesConnected:d["a"],Map:u["a"],Maps:m["a"],Title:f["a"],Footer:o["a"],FooterClosing:l["a"]},methods:{getDeviceData:function(){var t=Object(r["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e=this,t.next=4,this.axios.get("https://api.oehu.org/devices?deviceId="+this.deviceId);case 4:a=t.sent,this.handleDevicesData(a.data[0]),setTimeout(function(){e.getDeviceData()},1e4),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),console.error(t.t0);case 12:case"end":return t.stop()}},t,this,[[0,9]])}));return function(){return t.apply(this,arguments)}}(),handleDevicesData:function(t){this.devices.push({id:t.deviceId,position:{lat:t.metadata.metadata.location.coordinates[0],lng:t.metadata.metadata.location.coordinates[1]},electricityReceived:t.metadata.electricityReceived,electricityDelivered:t.metadata.electricityDelivered,gasReceived:t.metadata.gasReceived}),this.electricityReceived=t.metadata.metadata.electricityReceived.total,this.electricityDelivered=t.metadata.metadata.electricityDelivered.total,this.gasReceived=t.metadata.metadata.gasReceived}},mounted:function(){this.deviceId=self.$cookies.get("devices"),this.getDeviceData()}},_=h,g=(a("7e14"),a("2877")),y=Object(g["a"])(_,i,c,!1,null,"7ae4b4b4",null);y.options.__file="Explorer.vue";e["default"]=y.exports},d02a:function(t,e,a){"use strict";var i=a("aff5"),c=a.n(i);c.a}}]);
//# sourceMappingURL=chunk-4ba45aeb.4497b823.js.map